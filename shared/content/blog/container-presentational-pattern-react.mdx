---
title: 'Container/Presentational Pattern trong React v·ªõi TypeScript'
date: '2025-01-21'
tags: ['react', 'typescript', 'design-patterns', 'architecture', 'best-practices']
draft: false
summary: 'T√¨m hi·ªÉu v·ªÅ Container/Presentational pattern trong React - m·ªôt pattern gi√∫p t√°ch bi·ªát logic v√† UI, c·∫£i thi·ªán kh·∫£ nƒÉng t√°i s·ª≠ d·ª•ng v√† test. B√†i vi·∫øt k√®m code demo TypeScript th·ª±c t·∫ø.'
authors: ['default']
layout: 'PostLayout'
---

## Gi·ªõi thi·ªáu Container/Presentational Pattern

Container/Presentational Pattern (c√≤n g·ªçi l√† Smart/Dumb Components) l√† m·ªôt trong nh·ªØng design patterns ph·ªï bi·∫øn nh·∫•t trong React. Pattern n√†y ƒë∆∞·ª£c Dan Abramov (t√°c gi·∫£ Redux) gi·ªõi thi·ªáu v√† ƒë√£ tr·ªü th√†nh m·ªôt c√°ch ti·∫øp c·∫≠n chu·∫©n ƒë·ªÉ t·ªï ch·ª©c code React.

**√ù t∆∞·ªüng c·ªët l√µi:** T√°ch bi·ªát c√°c component th√†nh hai lo·∫°i ch√≠nh:

- **Container Components** (Smart): Qu·∫£n l√Ω logic, state, v√† side effects
- **Presentational Components** (Dumb): Ch·ªâ t·∫≠p trung v√†o vi·ªác hi·ªÉn th·ªã UI

## T·∫°i sao n√™n s·ª≠ d·ª•ng pattern n√†y?

### L·ª£i √≠ch ch√≠nh:

1. **T√°ch bi·ªát tr√°ch nhi·ªám r√µ r√†ng** - Logic v√† UI ho√†n to√†n ƒë·ªôc l·∫≠p
2. **D·ªÖ test h∆°n** - Presentational components d·ªÖ test, Container components t·∫≠p trung logic
3. **T√°i s·ª≠ d·ª•ng cao** - Presentational components c√≥ th·ªÉ s·ª≠ d·ª•ng ·ªü nhi·ªÅu n∆°i kh√°c nhau
4. **D·ªÖ maintain** - Thay ƒë·ªïi logic kh√¥ng ·∫£nh h∆∞·ªüng UI v√† ng∆∞·ª£c l·∫°i
5. **Team collaboration t·ªët h∆°n** - Designer c√≥ th·ªÉ t·∫≠p trung v√†o Presentational, Developer t·∫≠p trung v√†o Container

## ƒê·∫∑c ƒëi·ªÉm c·ªßa t·ª´ng lo·∫°i component

### Presentational Components

**ƒê·∫∑c ƒëi·ªÉm:**

- Ch·ªâ nh·∫≠n props v√† render UI
- Kh√¥ng c√≥ local state (tr∆∞·ªõc Hooks) ho·∫∑c ch·ªâ c√≥ UI state ƒë∆°n gi·∫£n
- Kh√¥ng th·ª±c hi·ªán side effects
- Th∆∞·ªùng l√† functional components
- C√≥ th·ªÉ ch·ª©a c·∫£ Presentational v√† Container components con

### Container Components

**ƒê·∫∑c ƒëi·ªÉm:**

- Cung c·∫•p data v√† behavior cho Presentational components
- Th∆∞·ªùng c√≥ state v√† lifecycle methods
- G·ªçi API, x·ª≠ l√Ω side effects
- Th∆∞·ªùng wrap c√°c Presentational components
- √çt ho·∫∑c kh√¥ng c√≥ markup ri√™ng

## V√≠ d·ª• th·ª±c t·∫ø: Todo App

H√£y c√πng x√¢y d·ª±ng m·ªôt Todo App ƒë∆°n gi·∫£n ƒë·ªÉ minh h·ªça pattern n√†y.

### 1. ƒê·ªãnh nghƒ©a Types

```typescript
// types/todo.ts
export interface Todo {
  id: string;
  text: string;
  completed: boolean;
  createdAt: Date;
}

export interface TodoFormData {
  text: string;
}

export interface TodoStats {
  total: number;
  completed: number;
  pending: number;
}
```

### 2. Presentational Components

#### TodoItem Component

```typescript
// components/todo-item.tsx
import { Todo } from '../types/todo';

interface TodoItemProps {
  todo: Todo;
  onToggle: (id: string) => void;
  onDelete: (id: string) => void;
  onEdit: (id: string, newText: string) => void;
}

export const TodoItem = ({
  todo,
  onToggle,
  onDelete,
  onEdit
}: TodoItemProps) => {
  const [isEditing, setIsEditing] = useState(false);
  const [editText, setEditText] = useState(todo.text);

  const handleEdit = () => {
    if (isEditing && editText.trim()) {
      onEdit(todo.id, editText.trim());
    }
    setIsEditing(!isEditing);
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      handleEdit();
    } else if (e.key === 'Escape') {
      setEditText(todo.text);
      setIsEditing(false);
    }
  };

  return (
    <div className={`todo-item ${todo.completed ? 'completed' : ''}`}>
      <input
        type="checkbox"
        checked={todo.completed}
        onChange={() => onToggle(todo.id)}
        className="todo-checkbox"
      />

      {isEditing ? (
        <input
          type="text"
          value={editText}
          onChange={(e) => setEditText(e.target.value)}
          onKeyDown={handleKeyDown}
          onBlur={handleEdit}
          className="todo-edit-input"
          autoFocus
        />
      ) : (
        <span
          className="todo-text"
          onDoubleClick={() => setIsEditing(true)}
        >
          {todo.text}
        </span>
      )}

      <div className="todo-actions">
        <button
          onClick={handleEdit}
          className="edit-btn"
          disabled={todo.completed}
        >
          {isEditing ? '‚úì' : '‚úèÔ∏è'}
        </button>

        <button
          onClick={() => onDelete(todo.id)}
          className="delete-btn"
        >
          üóëÔ∏è
        </button>
      </div>
    </div>
  );
};
```

#### TodoList Component

```typescript
// components/todo-list.tsx
import { Todo } from '../types/todo';
import { TodoItem } from './todo-item';

interface TodoListProps {
  todos: Todo[];
  onToggle: (id: string) => void;
  onDelete: (id: string) => void;
  onEdit: (id: string, newText: string) => void;
  emptyMessage?: string;
}

export const TodoList = ({
  todos,
  onToggle,
  onDelete,
  onEdit,
  emptyMessage = "Kh√¥ng c√≥ todo n√†o"
}: TodoListProps) => {
  if (todos.length === 0) {
    return (
      <div className="empty-state">
        <p>{emptyMessage}</p>
      </div>
    );
  }

  return (
    <div className="todo-list">
      {todos.map((todo) => (
        <TodoItem
          key={todo.id}
          todo={todo}
          onToggle={onToggle}
          onDelete={onDelete}
          onEdit={onEdit}
        />
      ))}
    </div>
  );
};
```

#### TodoForm Component

```typescript
// components/todo-form.tsx
import { useState } from 'react';
import { TodoFormData } from '../types/todo';

interface TodoFormProps {
  onSubmit: (data: TodoFormData) => void;
  placeholder?: string;
  buttonText?: string;
  isLoading?: boolean;
}

export const TodoForm = ({
  onSubmit,
  placeholder = "Th√™m todo m·ªõi...",
  buttonText = "Th√™m",
  isLoading = false
}: TodoFormProps) => {
  const [text, setText] = useState('');

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();

    if (!text.trim()) return;

    onSubmit({ text: text.trim() });
    setText('');
  };

  return (
    <form onSubmit={handleSubmit} className="todo-form">
      <input
        type="text"
        value={text}
        onChange={(e) => setText(e.target.value)}
        placeholder={placeholder}
        disabled={isLoading}
        className="todo-input"
      />

      <button
        type="submit"
        disabled={!text.trim() || isLoading}
        className="submit-btn"
      >
        {isLoading ? 'ƒêang th√™m...' : buttonText}
      </button>
    </form>
  );
};
```

#### TodoStats Component

```typescript
// components/todo-stats.tsx
import { TodoStats as Stats } from '../types/todo';

interface TodoStatsProps {
  stats: Stats;
  className?: string;
}

export const TodoStats = ({ stats, className }: TodoStatsProps) => {
  const completionRate = stats.total > 0
    ? Math.round((stats.completed / stats.total) * 100)
    : 0;

  return (
    <div className={`todo-stats ${className || ''}`}>
      <div className="stats-grid">
        <div className="stat-item">
          <span className="stat-number">{stats.total}</span>
          <span className="stat-label">T·ªïng c·ªông</span>
        </div>

        <div className="stat-item">
          <span className="stat-number">{stats.completed}</span>
          <span className="stat-label">Ho√†n th√†nh</span>
        </div>

        <div className="stat-item">
          <span className="stat-number">{stats.pending}</span>
          <span className="stat-label">Ch∆∞a xong</span>
        </div>

        <div className="stat-item">
          <span className="stat-number">{completionRate}%</span>
          <span className="stat-label">Ti·∫øn ƒë·ªô</span>
        </div>
      </div>

      <div className="progress-bar">
        <div
          className="progress-fill"
          style={{ width: `${completionRate}%` }}
        />
      </div>
    </div>
  );
};
```

### 3. Custom Hooks (Logic Layer)

```typescript
// hooks/use-todos.ts
import { useState, useCallback, useMemo } from 'react';
import { Todo, TodoFormData, TodoStats } from '../types/todo';

export const useTodos = (initialTodos: Todo[] = []) => {
  const [todos, setTodos] = useState<Todo[]>(initialTodos);
  const [isLoading, setIsLoading] = useState(false);

  const addTodo = useCallback(async (data: TodoFormData) => {
    setIsLoading(true);

    // Simulate API call
    await new Promise((resolve) => setTimeout(resolve, 500));

    const newTodo: Todo = {
      id: Date.now().toString(),
      text: data.text,
      completed: false,
      createdAt: new Date(),
    };

    setTodos((prev) => [newTodo, ...prev]);
    setIsLoading(false);
  }, []);

  const toggleTodo = useCallback((id: string) => {
    setTodos((prev) =>
      prev.map((todo) => (todo.id === id ? { ...todo, completed: !todo.completed } : todo)),
    );
  }, []);

  const deleteTodo = useCallback((id: string) => {
    setTodos((prev) => prev.filter((todo) => todo.id !== id));
  }, []);

  const editTodo = useCallback((id: string, newText: string) => {
    setTodos((prev) => prev.map((todo) => (todo.id === id ? { ...todo, text: newText } : todo)));
  }, []);

  const clearCompleted = useCallback(() => {
    setTodos((prev) => prev.filter((todo) => !todo.completed));
  }, []);

  const stats: TodoStats = useMemo(() => {
    const total = todos.length;
    const completed = todos.filter((todo) => todo.completed).length;
    const pending = total - completed;

    return { total, completed, pending };
  }, [todos]);

  return {
    todos,
    stats,
    isLoading,
    actions: {
      addTodo,
      toggleTodo,
      deleteTodo,
      editTodo,
      clearCompleted,
    },
  };
};
```

### 4. Container Component

```typescript
// containers/todo-app-container.tsx
import { useTodos } from '../hooks/use-todos';
import { TodoForm } from '../components/todo-form';
import { TodoList } from '../components/todo-list';
import { TodoStats } from '../components/todo-stats';

interface TodoAppContainerProps {
  initialTodos?: Todo[];
  title?: string;
}

export const TodoAppContainer = ({
  initialTodos,
  title = "My Todo App"
}: TodoAppContainerProps) => {
  const { todos, stats, isLoading, actions } = useTodos(initialTodos);

  return (
    <div className="todo-app">
      <header className="app-header">
        <h1>{title}</h1>
        <TodoStats stats={stats} />
      </header>

      <main className="app-main">
        <TodoForm
          onSubmit={actions.addTodo}
          isLoading={isLoading}
        />

        <TodoList
          todos={todos}
          onToggle={actions.toggleTodo}
          onDelete={actions.deleteTodo}
          onEdit={actions.editTodo}
        />
      </main>

      <footer className="app-footer">
        {stats.completed > 0 && (
          <button
            onClick={actions.clearCompleted}
            className="clear-btn"
          >
            X√≥a c√°c todo ƒë√£ ho√†n th√†nh ({stats.completed})
          </button>
        )}
      </footer>
    </div>
  );
};
```

### 5. Usage Example

```typescript
// App.tsx
import { TodoAppContainer } from './containers/todo-app-container';

const App = () => {
  const initialTodos = [
    {
      id: '1',
      text: 'H·ªçc React Pattern',
      completed: false,
      createdAt: new Date(),
    },
    {
      id: '2',
      text: 'Vi·∫øt blog v·ªÅ Container/Presentational',
      completed: true,
      createdAt: new Date(),
    },
  ];

  return (
    <div className="app">
      <TodoAppContainer
        initialTodos={initialTodos}
        title="Todo App v·ªõi Container/Presentational Pattern"
      />
    </div>
  );
};

export default App;
```

## Advanced: V·ªõi React Context

ƒê·ªëi v·ªõi ·ª©ng d·ª•ng l·ªõn h∆°n, b·∫°n c√≥ th·ªÉ combine pattern n√†y v·ªõi Context API:

```typescript
// contexts/todo-context.tsx
import { createContext, useContext } from 'react';
import { useTodos } from '../hooks/use-todos';

const TodoContext = createContext<ReturnType<typeof useTodos> | null>(null);

export const TodoProvider = ({ children }: { children: React.ReactNode }) => {
  const todoState = useTodos();

  return (
    <TodoContext.Provider value={todoState}>
      {children}
    </TodoContext.Provider>
  );
};

export const useTodoContext = () => {
  const context = useContext(TodoContext);
  if (!context) {
    throw new Error('useTodoContext must be used within TodoProvider');
  }
  return context;
};

// Container component v·ªõi context
export const TodoAppWithContext = () => {
  return (
    <TodoProvider>
      <TodoAppContainer />
    </TodoProvider>
  );
};
```

## Testing Strategy

### Testing Presentational Components

```typescript
// __tests__/todo-item.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { TodoItem } from '../components/todo-item';

const mockTodo = {
  id: '1',
  text: 'Test todo',
  completed: false,
  createdAt: new Date(),
};

const mockProps = {
  todo: mockTodo,
  onToggle: jest.fn(),
  onDelete: jest.fn(),
  onEdit: jest.fn(),
};

describe('TodoItem', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  it('renders todo text correctly', () => {
    render(<TodoItem {...mockProps} />);
    expect(screen.getByText('Test todo')).toBeInTheDocument();
  });

  it('calls onToggle when checkbox is clicked', () => {
    render(<TodoItem {...mockProps} />);

    const checkbox = screen.getByRole('checkbox');
    fireEvent.click(checkbox);

    expect(mockProps.onToggle).toHaveBeenCalledWith('1');
  });

  it('enters edit mode on double click', () => {
    render(<TodoItem {...mockProps} />);

    const textElement = screen.getByText('Test todo');
    fireEvent.doubleClick(textElement);

    expect(screen.getByRole('textbox')).toBeInTheDocument();
  });
});
```

### Testing Container Logic

```typescript
// __tests__/use-todos.test.ts
import { renderHook, act } from '@testing-library/react';
import { useTodos } from '../hooks/use-todos';

describe('useTodos', () => {
  it('should add new todo', async () => {
    const { result } = renderHook(() => useTodos());

    await act(async () => {
      await result.current.actions.addTodo({ text: 'New todo' });
    });

    expect(result.current.todos).toHaveLength(1);
    expect(result.current.todos[0].text).toBe('New todo');
    expect(result.current.todos[0].completed).toBe(false);
  });

  it('should toggle todo completion', () => {
    const initialTodos = [
      {
        id: '1',
        text: 'Test',
        completed: false,
        createdAt: new Date(),
      },
    ];

    const { result } = renderHook(() => useTodos(initialTodos));

    act(() => {
      result.current.actions.toggleTodo('1');
    });

    expect(result.current.todos[0].completed).toBe(true);
  });
});
```

## Khi n√†o n√™n s·ª≠ d·ª•ng pattern n√†y?

### ‚úÖ N√™n s·ª≠ d·ª•ng khi:

- Component c√≥ logic ph·ª©c t·∫°p (API calls, state management)
- C·∫ßn t√°i s·ª≠ d·ª•ng UI component v·ªõi data kh√°c nhau
- Team c√≥ nhi·ªÅu ng∆∞·ªùi (t√°ch bi·ªát c√¥ng vi·ªác UI/Logic)
- C·∫ßn test coverage cao
- D·ª± √°n l·ªõn, c·∫ßn maintainable architecture

### ‚ùå Kh√¥ng n√™n s·ª≠ d·ª•ng khi:

- Component ƒë∆°n gi·∫£n, ch·ªâ hi·ªÉn th·ªã static content
- D·ª± √°n nh·ªè, kh√¥ng c·∫ßn over-engineering
- Logic v√† UI qu√° g·∫Øn li·ªÅn nhau
- Performance kh√¥ng ph·∫£i concern ch√≠nh

## Modern Alternatives

V·ªõi s·ª± ra ƒë·ªùi c·ªßa React Hooks, pattern n√†y ƒë√£ ƒë∆∞·ª£c "soft deprecated" b·ªüi Dan Abramov. C√°c alternatives hi·ªán ƒë·∫°i:

### 1. Custom Hooks + Functional Components

```typescript
// Thay v√¨ Container component, s·ª≠ d·ª•ng custom hook
const TodoApp = () => {
  const { todos, actions } = useTodos();

  return (
    <div>
      <TodoForm onSubmit={actions.addTodo} />
      <TodoList todos={todos} onToggle={actions.toggleTodo} />
    </div>
  );
};
```

### 2. Compound Components Pattern

```typescript
const TodoApp = () => (
  <Todo.Provider>
    <Todo.Stats />
    <Todo.Form />
    <Todo.List />
  </Todo.Provider>
);
```

## K·∫øt lu·∫≠n

Container/Presentational Pattern v·∫´n l√† m·ªôt pattern h·ªØu √≠ch trong React, ƒë·∫∑c bi·ªát cho:

- **Team l·ªõn** c·∫ßn t√°ch bi·ªát tr√°ch nhi·ªám r√µ r√†ng
- **Enterprise applications** c·∫ßn ki·∫øn tr√∫c ·ªïn ƒë·ªãnh
- **Design systems** c·∫ßn component t√°i s·ª≠ d·ª•ng cao

Trong khi Hooks ƒë√£ l√†m pattern n√†y √≠t ph·ªï bi·∫øn h∆°n, nh·ªØng nguy√™n t·∫Øc c·ªët l√µi - **t√°ch bi·ªát logic v√† UI** - v·∫´n lu√¥n c√≥ gi√° tr·ªã trong b·∫•t k·ª≥ ·ª©ng d·ª•ng React n√†o.

Pattern n√†y kh√¥ng ch·ªâ gi√∫p code organized h∆°n, m√† c√≤n gi√∫p team collaboration t·ªët h∆°n v√† testing d·ªÖ d√†ng h∆°n. H√£y c√¢n nh·∫Øc s·ª≠ d·ª•ng khi d·ª± √°n c·ªßa b·∫°n c·∫ßn nh·ªØng l·ª£i √≠ch n√†y!
